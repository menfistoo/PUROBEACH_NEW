<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Paquete - Beach Club</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Beach Club Design System -->
    <link rel="stylesheet" href="../css/beach-club-design.css">

    <style>
        .input-group-text.currency {
            background-color: var(--warm-sand);
            color: var(--deep-ocean);
            font-weight: 600;
        }

        .capacity-inputs {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .capacity-inputs .form-control {
            max-width: 100px;
        }

        .furniture-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.75rem;
        }

        .furniture-checkboxes .form-check {
            margin: 0;
        }
    </style>
</head>
<body class="bg-light">

    <div class="container-fluid">
        <div class="row">

            <!-- Sidebar Navigation (for context) -->
            <div class="col-md-2 sidebar d-none d-md-block">
                <div class="mb-4">
                    <h4 class="text-white mb-3">
                        <i class="fas fa-umbrella-beach"></i> Beach Club
                    </h4>
                </div>

                <nav class="nav flex-column">
                    <a class="nav-link" href="#">
                        <i class="fas fa-map"></i> Mapa
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-calendar-check"></i> Reservas
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-users"></i> Clientes
                    </a>

                    <hr style="border-color: rgba(255,255,255,0.2);">

                    <div class="text-white-50 small px-3 mb-2">CONFIGURACIÓN</div>
                    <a class="nav-link active" href="package-list.html">
                        <i class="fas fa-box"></i> Paquetes
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-dollar-sign"></i> Consumo Mínimo
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-couch"></i> Mobiliario
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-map-marked-alt"></i> Zonas
                    </a>
                    <a class="nav-link" href="#">
                        <i class="fas fa-tasks"></i> Estados
                    </a>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 offset-md-2 p-4">

                <!-- Page Header -->
                <div class="page-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1>
                                <i class="fas fa-plus-circle"></i> Crear Nuevo Paquete
                            </h1>
                            <p class="mb-0">Configure un paquete de servicios con precios para reservas</p>
                        </div>
                        <a href="package-list.html" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver a Lista
                        </a>
                    </div>
                </div>

                <!-- Form Container -->
                <form id="packageForm" onsubmit="return handleSubmit(event)">

                    <!-- General Information Section -->
                    <div class="card mb-4">
                        <div class="section-divider">
                            <i class="fas fa-info-circle"></i> Información General
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Package Name -->
                                <div class="col-md-6">
                                    <label for="packageName" class="form-label">
                                        Nombre del Paquete <span class="required">*</span>
                                    </label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="packageName"
                                        name="packageName"
                                        placeholder='Ej: "Paquete Premium", "Día de Playa VIP"'
                                        required
                                    >
                                    <div class="form-text">Este nombre aparecerá en el selector de paquetes al crear reservas</div>
                                </div>

                                <!-- Display Order -->
                                <div class="col-md-6">
                                    <label for="displayOrder" class="form-label">
                                        Orden de Visualización
                                        <i class="fas fa-question-circle help-icon" title="Menor número = mayor prioridad en la lista"></i>
                                    </label>
                                    <input
                                        type="number"
                                        class="form-control"
                                        id="displayOrder"
                                        name="displayOrder"
                                        value="0"
                                        min="0"
                                    >
                                    <div class="form-text">Orden en el que aparece en listas (menor = primero)</div>
                                </div>

                                <!-- Package Description -->
                                <div class="col-12">
                                    <label for="packageDescription" class="form-label">
                                        Descripción
                                    </label>
                                    <textarea
                                        class="form-control"
                                        id="packageDescription"
                                        name="packageDescription"
                                        rows="3"
                                        placeholder="Describe los servicios incluidos en este paquete (opcional)"
                                    ></textarea>
                                    <div class="form-text">Ejemplo: "2 hamacas + sombrilla + toallas + bebida de bienvenida"</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pricing & Capacity Section -->
                    <div class="card mb-4">
                        <div class="section-divider">
                            <i class="fas fa-euro-sign"></i> Precio y Capacidad
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Base Price -->
                                <div class="col-md-6">
                                    <label for="basePrice" class="form-label">
                                        Precio Base <span class="required">*</span>
                                    </label>
                                    <div class="input-group">
                                        <input
                                            type="number"
                                            class="form-control"
                                            id="basePrice"
                                            name="basePrice"
                                            step="0.01"
                                            min="0.01"
                                            placeholder="89.00"
                                            required
                                            oninput="updatePricePreview()"
                                        >
                                        <span class="input-group-text currency">€</span>
                                    </div>
                                    <div class="form-text">Precio base del paquete</div>
                                </div>

                                <!-- Price Type -->
                                <div class="col-md-6">
                                    <label class="form-label">
                                        Tipo de Precio <span class="required">*</span>
                                    </label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input
                                                class="form-check-input"
                                                type="radio"
                                                name="priceType"
                                                id="priceTypePackage"
                                                value="per_package"
                                                onchange="updatePricePreview()"
                                            >
                                            <label class="form-check-label" for="priceTypePackage">
                                                <i class="fas fa-box"></i> Por Paquete (precio fijo)
                                            </label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input
                                                class="form-check-input"
                                                type="radio"
                                                name="priceType"
                                                id="priceTypePerson"
                                                value="per_person"
                                                checked
                                                onchange="updatePricePreview()"
                                            >
                                            <label class="form-check-label" for="priceTypePerson">
                                                <i class="fas fa-user"></i> Por Persona (precio × personas)
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-text">
                                        <strong>Por Paquete:</strong> Precio fijo.
                                        <strong>Por Persona:</strong> Se multiplica por número de huéspedes
                                    </div>
                                </div>

                                <!-- Capacity -->
                                <div class="col-12">
                                    <label class="form-label">
                                        Capacidad de Personas <span class="required">*</span>
                                    </label>
                                    <div class="capacity-inputs">
                                        <div>
                                            <label for="minPeople" class="form-label small">Mínimo</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                id="minPeople"
                                                name="minPeople"
                                                min="1"
                                                value="1"
                                                required
                                                oninput="validateCapacity(); updatePricePreview()"
                                            >
                                        </div>
                                        <div>
                                            <label for="standardPeople" class="form-label small">Estándar (Recomendado)</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                id="standardPeople"
                                                name="standardPeople"
                                                min="1"
                                                value="2"
                                                required
                                                oninput="validateCapacity(); updatePricePreview()"
                                            >
                                        </div>
                                        <div>
                                            <label for="maxPeople" class="form-label small">Máximo</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                id="maxPeople"
                                                name="maxPeople"
                                                min="1"
                                                value="4"
                                                required
                                                oninput="validateCapacity(); updatePricePreview()"
                                            >
                                        </div>
                                    </div>
                                    <div class="form-text">
                                        Ejemplos: 1-2 personas, 2-4 personas, 1-6 personas.
                                        <strong>Regla:</strong> Mínimo ≤ Estándar ≤ Máximo
                                    </div>
                                    <div id="capacityError" class="invalid-feedback" style="display: none;">
                                        Error: Debe cumplirse Mínimo ≤ Estándar ≤ Máximo
                                    </div>
                                </div>

                                <!-- Price Preview -->
                                <div class="col-12">
                                    <div class="alert alert-info">
                                        <h6><i class="fas fa-calculator"></i> Vista Previa del Precio:</h6>
                                        <div id="pricePreview">
                                            <em>Configure precio y capacidad para ver la vista previa...</em>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Applicability Section -->
                    <div class="card mb-4">
                        <div class="section-divider">
                            <i class="fas fa-filter"></i> Aplicabilidad
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Customer Type -->
                                <div class="col-md-6">
                                    <label for="customerType" class="form-label">
                                        Tipo de Cliente
                                    </label>
                                    <select class="form-select" id="customerType" name="customerType">
                                        <option value="both" selected>Ambos (Interno y Externo)</option>
                                        <option value="interno">Solo Interno (Huéspedes Hotel)</option>
                                        <option value="externo">Solo Externo (Visitantes)</option>
                                    </select>
                                    <div class="form-text">A qué tipo de clientes aplica este paquete</div>
                                </div>

                                <!-- Zone -->
                                <div class="col-md-6">
                                    <label for="zoneId" class="form-label">
                                        Zona
                                    </label>
                                    <select class="form-select" id="zoneId" name="zoneId">
                                        <option value="" selected>Todas las zonas</option>
                                        <option value="1">Zona VIP</option>
                                        <option value="2">Zona Premium</option>
                                        <option value="3">Zona Familiar</option>
                                        <option value="4">Zona General</option>
                                    </select>
                                    <div class="form-text">Restringir a una zona específica (opcional)</div>
                                </div>

                                <!-- Furniture Types Included -->
                                <div class="col-12">
                                    <label class="form-label">
                                        Muebles Incluidos
                                    </label>
                                    <div class="furniture-checkboxes">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureHamaca" value="hamaca">
                                            <label class="form-check-label" for="furnitureHamaca">
                                                <i class="fas fa-chair"></i> Hamaca
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureSombrilla" value="sombrilla">
                                            <label class="form-check-label" for="furnitureSombrilla">
                                                <i class="fas fa-umbrella"></i> Sombrilla
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureBalinesa" value="balinesa">
                                            <label class="form-check-label" for="furnitureBalinesa">
                                                <i class="fas fa-bed"></i> Balinesa
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureToallas" value="toallas">
                                            <label class="form-check-label" for="furnitureToallas">
                                                <i class="fas fa-bath"></i> Toallas
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureMesa" value="mesa">
                                            <label class="form-check-label" for="furnitureMesa">
                                                <i class="fas fa-table"></i> Mesa
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="furnitureSilla" value="silla">
                                            <label class="form-check-label" for="furnitureSilla">
                                                <i class="fas fa-chair"></i> Silla
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-text">Seleccione los tipos de mobiliario incluidos en este paquete (opcional)</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Validity Period Section -->
                    <div class="card mb-4">
                        <div class="section-divider">
                            <i class="fas fa-calendar-alt"></i> Vigencia
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Valid From -->
                                <div class="col-md-6">
                                    <label for="validFrom" class="form-label">
                                        Válido Desde
                                    </label>
                                    <input
                                        type="date"
                                        class="form-control"
                                        id="validFrom"
                                        name="validFrom"
                                    >
                                    <div class="form-text">Fecha de inicio de vigencia (opcional)</div>
                                </div>

                                <!-- Valid Until -->
                                <div class="col-md-6">
                                    <label for="validUntil" class="form-label">
                                        Válido Hasta
                                    </label>
                                    <input
                                        type="date"
                                        class="form-control"
                                        id="validUntil"
                                        name="validUntil"
                                    >
                                    <div class="form-text">Fecha de fin de vigencia (opcional)</div>
                                </div>

                                <!-- Info Alert -->
                                <div class="col-12">
                                    <div class="alert alert-warning mb-0">
                                        <i class="fas fa-info-circle"></i>
                                        <strong>Nota:</strong> Si no especifica fechas, el paquete estará disponible todo el año.
                                        Use este campo para paquetes de temporada alta/baja.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Status Section -->
                    <div class="card mb-4">
                        <div class="section-divider">
                            <i class="fas fa-toggle-on"></i> Estado
                        </div>
                        <div class="card-body">
                            <div class="form-check form-switch">
                                <input
                                    class="form-check-input"
                                    type="checkbox"
                                    id="active"
                                    name="active"
                                    checked
                                    style="width: 3rem; height: 1.5rem;"
                                >
                                <label class="form-check-label" for="active">
                                    <strong>Paquete Activo</strong>
                                </label>
                            </div>
                            <div class="form-text">
                                Solo los paquetes activos aparecen al crear reservas.
                                Desactive paquetes fuera de temporada o descontinuados.
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between align-items-center">
                        <a href="package-list.html" class="btn btn-secondary btn-lg">
                            <i class="fas fa-times"></i> Cancelar
                        </a>
                        <div>
                            <button type="submit" class="btn btn-primary btn-lg me-2">
                                <i class="fas fa-save"></i> Guardar Paquete
                            </button>
                            <button type="button" class="btn btn-outline-primary btn-lg" onclick="previewPackage()">
                                <i class="fas fa-eye"></i> Vista Previa
                            </button>
                        </div>
                    </div>

                </form>

            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script>
        // Validate capacity constraints
        function validateCapacity() {
            const min = parseInt(document.getElementById('minPeople').value) || 0;
            const standard = parseInt(document.getElementById('standardPeople').value) || 0;
            const max = parseInt(document.getElementById('maxPeople').value) || 0;

            const isValid = min <= standard && standard <= max;
            const errorDiv = document.getElementById('capacityError');

            if (!isValid && min > 0 && standard > 0 && max > 0) {
                errorDiv.style.display = 'block';
                document.getElementById('minPeople').classList.add('is-invalid');
                document.getElementById('standardPeople').classList.add('is-invalid');
                document.getElementById('maxPeople').classList.add('is-invalid');
            } else {
                errorDiv.style.display = 'none';
                document.getElementById('minPeople').classList.remove('is-invalid');
                document.getElementById('standardPeople').classList.remove('is-invalid');
                document.getElementById('maxPeople').classList.remove('is-invalid');
            }

            return isValid;
        }

        // Update price preview
        function updatePricePreview() {
            const price = parseFloat(document.getElementById('basePrice').value) || 0;
            const priceType = document.querySelector('input[name="priceType"]:checked').value;
            const min = parseInt(document.getElementById('minPeople').value) || 1;
            const standard = parseInt(document.getElementById('standardPeople').value) || 2;
            const max = parseInt(document.getElementById('maxPeople').value) || 4;

            if (price > 0) {
                let preview = '<div>';

                if (priceType === 'per_person') {
                    preview += `<div class="mb-2">
                        <strong>Tipo:</strong> Por Persona<br>
                        <strong>Precio Base:</strong> €${price.toFixed(2)} por persona
                    </div>`;
                    preview += '<div><strong>Ejemplos de cálculo:</strong></div>';
                    preview += `<ul class="mb-0">
                        <li>${min} persona(s): €${price.toFixed(2)} × ${min} = <strong class="text-success">€${(price * min).toFixed(2)}</strong></li>
                        <li>${standard} persona(s) (estándar): €${price.toFixed(2)} × ${standard} = <strong class="text-success">€${(price * standard).toFixed(2)}</strong></li>
                        <li>${max} persona(s): €${price.toFixed(2)} × ${max} = <strong class="text-success">€${(price * max).toFixed(2)}</strong></li>
                    </ul>`;
                } else {
                    preview += `<div class="mb-2">
                        <strong>Tipo:</strong> Por Paquete (Precio Fijo)<br>
                        <strong>Precio:</strong> €${price.toFixed(2)} por paquete
                    </div>`;
                    preview += '<div><strong>Ejemplos de cálculo:</strong></div>';
                    preview += `<ul class="mb-0">
                        <li>${min} persona(s): <strong class="text-success">€${price.toFixed(2)}</strong> (fijo)</li>
                        <li>${standard} persona(s) (estándar): <strong class="text-success">€${price.toFixed(2)}</strong> (fijo)</li>
                        <li>${max} persona(s): <strong class="text-success">€${price.toFixed(2)}</strong> (fijo)</li>
                    </ul>`;
                }

                preview += '</div>';
                document.getElementById('pricePreview').innerHTML = preview;
            }
        }

        // Preview package
        function previewPackage() {
            const packageName = document.getElementById('packageName').value || 'Sin nombre';
            const description = document.getElementById('packageDescription').value || 'Sin descripción';
            const price = parseFloat(document.getElementById('basePrice').value) || 0;
            const priceType = document.querySelector('input[name="priceType"]:checked').value;
            const min = document.getElementById('minPeople').value;
            const standard = document.getElementById('standardPeople').value;
            const max = document.getElementById('maxPeople').value;

            const priceTypeText = priceType === 'per_person' ? 'Por Persona' : 'Por Paquete';

            alert(
                `VISTA PREVIA DEL PAQUETE\n\n` +
                `Nombre: ${packageName}\n` +
                `Descripción: ${description}\n\n` +
                `Precio: €${price.toFixed(2)} (${priceTypeText})\n` +
                `Capacidad: ${min}-${max} personas (estándar: ${standard})\n\n` +
                `Esta es una simulación. En la implementación real, se mostraría un modal con formato completo.`
            );
        }

        // Handle form submission
        function handleSubmit(event) {
            event.preventDefault();

            if (!validateCapacity()) {
                alert('Error: Por favor corrija los errores de capacidad antes de guardar.');
                return false;
            }

            // In real implementation, this would submit via AJAX
            alert('✓ Paquete guardado exitosamente!\n\n(Esta es una simulación del mockup)');

            // Simulated redirect
            setTimeout(() => {
                window.location.href = 'package-list.html';
            }, 1500);

            return false;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updatePricePreview();
        });
    </script>
</body>
</html>
